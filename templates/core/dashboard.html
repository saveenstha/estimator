{% extends 'base.html' %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h2>Dashboard</h2>
    <!-- chart -->
    <canvas id="chartBudgets" width="400" height="160"></canvas>
    <h3 class="mt-5">Projects by Status</h3>
        <div class="row">
          {% for status, qs in status_projects %}
          <div class="col-md-4">
            <h5>{{ status }} ({{ qs|length }})</h5>
            <ul class="list-group">
              {% for p in qs %}
              <li class="list-group-item">{{ p.name }} â€“ Rs. {{ p.budget }}</li>
              {% empty %}
              <li class="list-group-item text-muted">No {{ status|lower }} projects.</li>
              {% endfor %}
            </ul>
          </div>
          {% endfor %}
</div>
    <h4 class="mt-5">Procurement Overview</h4>
    <ul class="list-group mb-3">
      <li class="list-group-item">Total Procurement Records: {{ total_procurements }}</li>
      <li class="list-group-item text-success">Fulfilled: {{ fulfilled }}</li>
      <li class="list-group-item text-danger">Pending: {{ pending }}</li>
    </ul>
    <a href="{% url 'procurement-list' %}" class="btn btn-outline-primary">View All Procurements</a>


{% endblock %}
    <script>
        const data = {
          labels: {{ labels|safe }},
          datasets: [{
            label: 'Budget per Project',
            backgroundColor: 'rgba(54,73,93,.5)',
            borderColor: '#36495d',
            data: {{ budgets|safe }},
          }]
        };
        new Chart(document.getElementById('chartBudgets'), {
          type: 'bar',
          data: data,
          options: {}
        });
        </script>
